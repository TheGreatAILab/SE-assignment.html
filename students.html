<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ™ºèƒ½è¯¾å ‚ç®¡ç†ç³»ç»Ÿ</title>
  <style>
    /* åŸºç¡€æ ·å¼ */
    body {
      font-family: 'å¾®è½¯é›…é»‘', Arial, sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    /* ç‚¹åæŒ‰é’®æ ·å¼ */
    #pickBtn {
      background: #409eff;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      margin: 20px 0;
    }

    #pickBtn:hover {
      background: #66b1ff;
      transform: translateY(-2px);
    }

    /* ç»“æœæ˜¾ç¤º */
    #result {
      font-size: 24px;
      color: #303133;
      margin: 20px 0;
      min-height: 40px;
    }

    /* æ§åˆ¶é¢æ¿ */
    .control-panel {
      border: 1px solid #ebeef5;
      padding: 20px;
      border-radius: 8px;
      margin-top: 30px;
    }

    .input-group {
      display: flex;
      gap: 10px;
      margin: 15px 0;
    }

    input[type="text"], 
    input[type="file"] {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #dcdfe6;
      border-radius: 4px;
      font-size: 14px;
    }

    /* å­¦ç”Ÿåˆ—è¡¨ */
    #studentList {
      margin-top: 20px;
    }

    #studentList ul {
      list-style: none;
      padding: 0;
      max-height: 300px;
      overflow-y: auto;
    }

    .student-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      border-bottom: 1px solid #ebeef5;
      transition: background 0.3s;
    }

    .student-item:hover {
      background: #f5f7fa;
    }

    .delete-btn {
      background: #f56c6c;
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      cursor: pointer;
      line-height: 24px;
    }

    /* æ“ä½œæŒ‰é’® */
    .action-btn {
      background: #67c23a;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .action-btn:hover {
      opacity: 0.9;
    }

    .danger-btn {
      background: #f56c6c;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>è¯¾å ‚ç®¡ç†ç³»ç»Ÿ v2.0</h1>
    
    <!-- ç‚¹åæ¨¡å— -->
    <div class="rollcall-section">
      <button id="pickBtn" onclick="pickStudent()">ğŸ¯ éšæœºç‚¹å</button>
      <div id="result"></div>
    </div>

    <!-- å­¦ç”Ÿç®¡ç†æ¨¡å— -->
    <div class="control-panel">
      <h2>å­¦ç”Ÿç®¡ç†</h2>
      
      <div class="input-group">
        <input type="file" id="fileInput" accept=".csv" hidden>
        <button class="action-btn" onclick="document.getElementById('fileInput').click()">
          ğŸ“ å¯¼å…¥CSV
        </button>
        <input type="text" id="studentInput" placeholder="è¾“å…¥å§“å/å­¦å·">
        <button class="action-btn" onclick="addStudent()">â• æ·»åŠ </button>
        <button class="action-btn danger-btn" onclick="deleteStudent()">ğŸ—‘ï¸ åˆ é™¤</button>
        <button class="action-btn danger-btn" onclick="clearAll()">â™»ï¸ æ¸…ç©º</button>
      </div>

      <div id="studentList">
        <h3>å½“å‰åå•ï¼ˆå…±<span id="count">0</span>äººï¼‰</h3>
        <ul id="list"></ul>
      </div>
    </div>
  </div>

  <script>
    // åˆå§‹åŒ–å­¦ç”Ÿæ•°ç»„
    let students = JSON.parse(localStorage.getItem('students')) || ["è°¢æ…§è±ª",
"è‚–é‡‘æ´‹",
"22368031",
"22361058",
"ç½—æ–¯",
"æ²ˆå˜‰ä¹",
"æä½³éŸ³",
"ä¸çƒèŠ",
"22346095",
"23354177",
"23355032",
"æœ±æ½‡ç‘¶",
"23364037",
"é»„æ¶¦è½©",
"è®¸æ¢“çƒ",
"æ¨é‘«",
"è©¹ä¼Ÿç¿”",
"ç« è±ªæ–Œ",
"23336336",
"ä¸å¥•è½©",
"23331059",
"å½­å¿—æ³“",
"ç‹é˜³æ˜",
"å´æ‰¿å¾½",
"å´ä½³éœ–",
"23336250",
"å´ç¿",
"å´æ·±è£",
"23336253",
"å´æ™“æ’",
"23336255",
"23336259",
"23336260",
"è°¢å®¶å’Œ",
"è°¢æ¶¦æ–‡",
"ç†Šæ˜Šç¿”",
"23336266",
"å¾è§‚ç‚¼",
"å¾ä¸Š",
"å¾å­æ¬£",
"23336270",
"è®¸å›å…°",
"é—«éºŸæ˜Š",
"é˜³æ–‡è½©",
"æ¨å‡¯",
"æ¨ç«‹æ–°",
"23336279",
"23336278",
"æ¨å¸Œå‡¯",
"23336282",
"æ¨æ­£å®‡",
"23336286",
"23336287",
"å¶å´‡æ°",
"23336289",
"äºè¿œæ´‹",
"ä½™ä¿Šç¿°",
"ä½™é‘«",
"å¼ è‹‡èˆª",
"å…ƒæœ—æ›¦",
"è¢èˆœéª",
"å²³å³»å®‡",
"è©¹ä½³çƒ¨",
"å¼ åšç„¶",
"23336301",
"23336302",
"å¼ æ™¯ç¿”",
"23336305",
"å¼ äººå¿ƒ",
"23336307",
"23336309",
"å¼ æ–‡ç¿”",
"å¼ ç›¸é’Š",
"å¼ æ™”",
"23336313",
"å¼ é¢–ç³",
"å¼ å®‡ç„¶",
"å¼ ç‰ç‘¶",
"23336318",
"23336317",
"23336324",
"23336326",
"éƒ‘æµ©ç¿”",
"éƒ‘çš“",
"éƒ‘æ™‹å‡¯",
"23336331",
"23336332",
"éƒ‘é‘«å®‡",
"éƒ‘èŠ¸ç†™",
"èŒé›¨æ¬£",
"23336338",
"é’Ÿä¿Šå–†",
"é’Ÿæ€ç¥",
"23336342",
"å‘¨æµ·é“­",
"23336346",
"23336348",
"23336350",
"å‘¨é›¨æ¡",
"23336353",
"é‚¹ä¹¦æ‰¿",
"23336017",
"23336016",
"23336015",
"23336018",
"23336019",
"å‘¨å­å¥",
"å¸¸æ·‡åš",
"23336032",
"23336033",
"23336042",
"é™ˆä»åŸ¹",
"é™ˆæ€è°‹",
"æ®µç‰é£",
"å¤åº·æ°",
"23336084",
"23336080",
"èƒ¡æ³‰",
"æå»¶æ³½",
"23336132",
"æ—ç¿ æ•",
"23336145",
"23336165",
"23336170",
"23336178",
"éƒ­é–å®‡"];
    let remainingStudents = [...students];

    // åˆå§‹åŒ–æ˜¾ç¤º
    function refreshList() {
      const listElement = document.getElementById('list');
      listElement.innerHTML = students
        .map(student => `
          <li class="student-item">
            <span>${student}</span>
            <button class="delete-btn" onclick="removeSingle('${student}')">Ã—</button>
          </li>
        `)
        .join('');
      
      document.getElementById('count').textContent = students.length;
      localStorage.setItem('students', JSON.stringify(students));
    }

    // æ–‡ä»¶å¯¼å…¥åŠŸèƒ½
    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      
      reader.onload = function(e) {
        const newStudents = e.target.result
          .split('\n')
          .map(line => line.trim())
          .filter(line => line.length > 0);
        
        // åˆå¹¶å¹¶å»é‡
        students = [...new Set([...students, ...newStudents])];
        remainingStudents = [...students];
        refreshList();
        alert(`æˆåŠŸå¯¼å…¥ ${newStudents.length} æ¡è®°å½•ï¼Œå½“å‰æ€»æ•°ï¼š${students.length}`);
      };
      
      reader.readAsText(file);
    });

    // æ·»åŠ å­¦ç”Ÿ
    function addStudent() {
      const input = document.getElementById('studentInput').value.trim();
      if (!input) return;

      if (!students.includes(input)) {
        students.push(input);
        remainingStudents.push(input);
        refreshList();
        document.getElementById('studentInput').value = '';
      } else {
        alert('è¯¥å­¦ç”Ÿå·²å­˜åœ¨ï¼');
      }
    }

    // åˆ é™¤å­¦ç”Ÿ
    function deleteStudent() {
      const input = document.getElementById('studentInput').value.trim();
      if (!input) return;

      const index = students.findIndex(s => s.includes(input));
      if (index === -1) {
        alert('æœªæ‰¾åˆ°è¯¥å­¦ç”Ÿ');
        return;
      }
      
      students.splice(index, 1);
      remainingStudents = remainingStudents.filter(s => s !== students[index]);
      refreshList();
    }

    // æ¸…ç©ºåå•
    function clearAll() {
      if (confirm('ç¡®è®¤æ¸…ç©ºæ‰€æœ‰å­¦ç”Ÿæ•°æ®ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
        students = [];
        remainingStudents = [];
        refreshList();
      }
    }

    // å•æ¡åˆ é™¤
    function removeSingle(name) {
      students = students.filter(s => s !== name);
      remainingStudents = remainingStudents.filter(s => s !== name);
      refreshList();
    }

    // éšæœºç‚¹ååŠŸèƒ½
    function pickStudent() {
      if (remainingStudents.length === 0) {
        if (!confirm('æ‰€æœ‰å­¦ç”Ÿå·²ç‚¹å®Œï¼Œæ˜¯å¦é‡æ–°å¼€å§‹ï¼Ÿ')) return;
        remainingStudents = [...students];
      }

      const index = Math.floor(Math.random() * remainingStudents.length);
      const picked = remainingStudents.splice(index, 1)[0];
      
      document.getElementById('result').innerHTML = `
        <span style="color:#409eff">ğŸ‰ æœ¬æ¬¡ç‚¹åˆ°ï¼š</span>
        <strong style="font-size:1.2em">${picked}</strong>
      `;
      
      // æ·»åŠ åŠ¨ç”»æ•ˆæœ
      const resultDiv = document.getElementById('result');
      resultDiv.style.animation = 'none';
      resultDiv.offsetHeight; // è§¦å‘é‡ç»˜
      resultDiv.style.animation = 'blink 0.5s 2';
    }

    // åˆå§‹åŒ–æ˜¾ç¤º
    window.onload = refreshList;

    // åŠ¨ç”»å®šä¹‰
    const style = document.createElement('style');
    style.textContent = `
      @keyframes blink {
        0% { opacity: 0; transform: translateY(-10px); }
        100% { opacity: 1; transform: translateY(0); }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>